<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lunive | Lunive Console</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;600&family=VT323&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* CORE ADMIN STYLE (Dark Redstone Obsidian) */
        :root {
            --bg-obsidian: #050506;
            --border-redstone: #be3144;
            --primary-redstone: #ff4757; 
            --gold-acc: #f4d03f;
            --text-admin: #e0e0e0;
            --bg-modal: rgba(5, 5, 6, 0.95);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Poppins', sans-serif; transition: all 0.2s;
            cursor: url('https://cur.cursors-4u.net/games/gam-4/gam388.cur'), auto !important;
        }

        body {
            background-color: var(--bg-obsidian);
            color: var(--text-admin); padding: 20px;
            display: flex; justify-content: center; min-height: 100vh;
        }

        .admin-wrapper {
            width: 100%; max-width: 900px;
            display: flex; flex-direction: column;
        }

        /* HEADER */
        .admin-header {
            text-align: center; margin-bottom: 30px; border-bottom: 2px dashed var(--border-redstone);
            padding-bottom: 15px; position: relative;
        }
        h1 { font-family: 'VT323', monospace; font-size: 3.2rem; color: var(--gold-acc); text-shadow: 0 0 15px rgba(244, 208, 63, 0.4); text-transform: uppercase;}
        .keeper-name { color: var(--primary-redstone); font-weight: 700;}
        .blink { animation: blinker 1.2s linear infinite; font-weight: bold; color: var(--primary-redstone); }

        /* PANEL KONSOL OBSIDIAN */
        .console-panel {
            background: rgba(10, 10, 12, 0.9);
            border: 4px solid #000;
            border-color: var(--border-redstone) #000 #000 var(--border-redstone); 
            padding: 20px;
            flex: 1; backdrop-filter: blur(10px);
            box-shadow: 0 10px 50px rgba(190, 49, 68, 0.2);
            position: relative;
        }

        .panel-meta { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; color: #888; font-size: 0.95rem; font-family: monospace;}

        /* LIST PENDING */
        .pending-container { max-height: 70vh; overflow-y: auto; padding-right: 5px; }
        ::-webkit-scrollbar { width: 5px; }
        ::-webkit-scrollbar-thumb { background: var(--border-redstone); }

        /* ITEM PENDING */
        .pending-item {
            background: rgba(0,0,0,0.5);
            border: 1px solid rgba(255,255,255,0.05);
            padding: 18px;
            margin-bottom: 15px;
            display: flex; flex-direction: column; gap: 10px;
            position: relative; animation: slideInPending 0.3s ease forwards;
        }
        .pending-item:hover { border-color: rgba(255, 71, 87, 0.3); background: rgba(190, 49, 68, 0.03); }

        .meta-line { display: flex; gap: 10px; align-items: center; font-size: 0.85rem; color: #aaa; border-bottom: 1px solid #222; padding-bottom: 5px; }
        .badge-type { padding: 3px 8px; border-radius: 2px; color: #fff; text-transform: uppercase; font-weight: bold; font-family: 'VT323', monospace; font-size: 1rem;}
        
        .msg-console { font-size: 1.1rem; color: #fff; background: rgba(0,0,0,0.6); padding: 12px; border-radius: 2px; border: 1px solid #222; font-weight: 300; font-style: italic;}

        /* TOMBOL AKSI KEEPER */
        .action-btns { display: flex; gap: 10px; }
        
        button { flex: 1; padding: 12px; border: 2px solid #000; font-weight: 700; cursor: pointer; text-transform: uppercase; font-size: 0.95rem; font-family: 'VT323', monospace; letter-spacing: 1px;}
        
        .btn-acc { background: #1e3718; color: #2ed573; border-color: #2ed573; box-shadow: inset 0 -3px 0 rgba(0,0,0,0.3); }
        .btn-acc:hover { background: #2ed573; color: #000; }
        
        .btn-deny { background: #371818; color: var(--primary-redstone); border-color: var(--primary-redstone); box-shadow: inset 0 -3px 0 rgba(0,0,0,0.3); }
        .btn-deny:hover { background: var(--primary-redstone); color: #000; }

        /* MODAL ARCHIVE */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9); display: none; justify-content: center; align-items: center; z-index: 100;
        }
        .modal-content {
            background: var(--bg-obsidian); border: 2px solid var(--border-redstone);
            width: 90%; max-width: 600px; max-height: 80vh; overflow-y: auto; padding: 25px; position: relative;
        }
        .close-modal { position: absolute; top: 10px; right: 15px; color: var(--primary-redstone); font-size: 1.5rem; cursor: pointer; }

        /* FLOATING BUTTONS */
        .float-container { position: fixed; bottom: 20px; right: 20px; display: flex; flex-direction: column; gap: 10px; }
        .refresh-float, .archive-float {
            background: rgba(0,0,0,0.8); border: 1px solid #444; color: #888;
            padding: 10px 18px; border-radius: 5px; font-size: 0.85rem;
            cursor: pointer; text-align: right; width: 180px; font-family: 'VT323', monospace;
        }
        .refresh-float:hover { border-color: var(--gold-acc); color: var(--gold-acc); }
        .archive-float:hover { border-color: #2ed573; color: #2ed573; }

        /* Animasi */
        @keyframes blinker { 50% { opacity: 0; } }
        @keyframes slideInPending { from { opacity: 0; transform: translateX(-10px); } to { opacity: 1; transform: translateX(0); } }

        /* Mobile */
        @media (max-width: 600px) {
            .action-btns { flex-direction: column; }
            .float-container { width: auto; }
        }
    </style>
</head>
<body>

    <div class="admin-wrapper">
        <div class="admin-header">
            <h1>Lunive Console</h1>
            <p style="color:#666">> CURHAT STATUS: <span class="blink">ONLINE</span> | Owner: <span class="keeper-name">Fahri</span> <span class="blink">_</span></p>
        </div>

        <div class="console-panel">
            <div class="panel-meta">
                <span>// Antrian List Pesan</span>
                <span id="pandingCount">0 item(s)</span>
            </div>

            <div id="adminList" class="pending-container">
                <div style="text-align:center; color:#333; margin-top:50px; font-family: monospace;">Memindai Chat...</div>
            </div>
        </div>
    </div>

    <div id="archiveModal" class="modal-overlay">
        <div class="modal-content">
            <span class="close-modal" onclick="closeArchive()">&times;</span>
            <h2 style="font-family:'VT323'; color: #2ed573; margin-bottom: 20px;">[ ARCHIVED / APPROVED MESSAGES ]</h2>
            <div id="archiveList"></div>
        </div>
    </div>

    <div class="float-container">
        <button class="archive-float" onclick="openArchive()">> OPEN ARCHIVE</button>
        <button class="refresh-float" onclick="location.reload()">> RE-SCAN CHAT</button>
    </div>

    <script>
        const KEY = 'lunive_medieval_rpg_db';

        function loadPending() {
            const raw = localStorage.getItem(KEY);
            const data = raw ? JSON.parse(raw) : [];
            const list = document.getElementById('adminList');
            const countEl = document.getElementById('pandingCount');

            const pending = data.filter(item => item.status === 'pending');
            countEl.innerText = `${pending.length} item(s)`;

            if(pending.length === 0) {
                list.innerHTML = `<div style="text-align:center; color:#444; margin-top:50px; font-family:monospace;">
                    > CHAT SECURE. NO PENDING SEALS.
                </div>`;
                return;
            }

            list.innerHTML = '';
            pending.forEach((item, index) => {
                const isBug = item.type === 'Bug';
                const badgeStyle = isBug ? `background: rgba(190, 49, 68, 0.2); color: #ff4757;` : `background: rgba(46, 213, 115, 0.2); color: #2ed573;`;
                const delay = index * 0.05;

                list.innerHTML += `
                    <div class="pending-item" style="animation-delay: ${delay}s">
                        <div class="meta-line">
                            <span class="badge-type" style="${badgeStyle}">${item.type.toUpperCase()}</span>
                            <span>Gamertag: <b style="color:#fff">${item.player}</b></span>
                            <span style="margin-left:auto; font-family:monospace; color: var(--gold-acc)">ID: ${item.id}</span>
                        </div>
                        <div class="msg-console">"${escapeHtml(item.msg)}"</div>
                        <div class="action-btns">
                            <button class="btn-deny" onclick="decide('${item.id}', 'reject')">/DENY (Hapus)</button>
                            <button class="btn-acc" onclick="decide('${item.id}', 'approve')">/APPROVE (ACC)</button>
                        </div>
                    </div>
                `;
            });
        }

        // FUNGSI ARCHIVE (PESAN APPROVED)
        function openArchive() {
            const raw = localStorage.getItem(KEY);
            const data = raw ? JSON.parse(raw) : [];
            const container = document.getElementById('archiveList');
            const approved = data.filter(item => item.status === 'approved');

            document.getElementById('archiveModal').style.display = 'flex';
            
            if(approved.length === 0) {
                container.innerHTML = '<p style="color:#555; font-family:monospace;">No approved messages found.</p>';
                return;
            }

            container.innerHTML = '';
            approved.forEach(item => {
                container.innerHTML += `
                    <div style="background:#111; padding:10px; margin-bottom:10px; border-left:3px solid #2ed573; position:relative;">
                        <div style="font-size:0.7rem; color:#888;">ID: ${item.id} | By: ${item.player}</div>
                        <div style="font-size:0.9rem; margin:5px 0;">${escapeHtml(item.msg)}</div>
                        <button onclick="decide('${item.id}', 'reject')" 
                                style="width:auto; padding:2px 10px; font-size:0.7rem; background:#371818; color:red; border-color:red;">
                                HAPUS PERMANEN
                        </button>
                    </div>
                `;
            });
        }

        function closeArchive() {
            document.getElementById('archiveModal').style.display = 'none';
        }

        window.decide = function(id, action) {
            let raw = localStorage.getItem(KEY);
            let data = raw ? JSON.parse(raw) : [];
            
            if(action === 'approve') {
                const idx = data.findIndex(x => x.id == id);
                if(idx !== -1) data[idx].status = 'approved';
            } else {
                data = data.filter(x => x.id != id);
            }

            localStorage.setItem(KEY, JSON.stringify(data));
            loadPending();
            if(document.getElementById('archiveModal').style.display === 'flex') openArchive();
            window.dispatchEvent(new Event('storage'));
        };

        function escapeHtml(text) {
            return text.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;");
        }

        window.addEventListener('storage', loadPending);
        loadPending();
    </script>
</body>
</html>